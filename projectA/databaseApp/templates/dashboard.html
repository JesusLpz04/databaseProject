{% extends 'base.html' %}


{% block content %}


    <h1>Welcome {{user}}</h1>
    
    {% for post in posts%}

        <div class ="card mt-2">
            <div class="card-header"><strong>@{{post.author.username}}</strong>
                {% if post.author != user %}
                {% if post.author not in user.profile.friends.all %}
                <form method="POST">
                {% csrf_token %}
                    <button type="submit" class="btn btn-success btn-sm" name="follow-btn" value="{{post.author.id}}">Follow</button>
                </form>
                {% endif %}
                {% endif %}
        </div>
            <div class="card-body d-flex flex-row justify-content-between">
                <div>
                    <div>
                        <h5 class="card-title">{{post.title}}</h5>
                        <p>{{post.description}}</p>
                    </div>
                </div>
                {% if user == post.author%}
                    <form method="POST">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-danger" name="post-id" value="{{post.id}}">Delete</button>
                    </form>
                {% endif %}
            </div>
            <div class="card-footer text-muted">{{post.created_at}}</div>
            <div class="card-footer">
                <h5>comments...</h5>  
                <div>
                    <a href="{% url 'comment' post.pk %}">Add Comment</a>
                </div>
                    <br>
                {% if not post.comments.all %}
                    No commets yet...
                
                {% else %}
                    {% for comment in post.comments.all %}
                        <strong>
                            {{comment.name}}- {{comment.date_added}}
                        </strong>
                        <br>
                        {{comment.body}}
                        {% if user == comment.name %}
                            <form method="POST">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-danger" name="comment-id" value="{{comment.id}}">Delete</button>
                            </form>
                        {% endif %}
                        <br><hr>

                    {% endfor %}

                {% endif %}
            </div>
            
        </div>
    {% endfor %}

{% endblock %}